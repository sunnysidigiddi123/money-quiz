name: Build & publish image
on:
  push:
    tags:
      - v[0-9]+.[0-9]+.[0-9]+-rc[0-9]
      - v[0-9]+.[0-9]+.[0-9]+
jobs:
 build-and-push-dockerimages:
    strategy:
     fail-fast: false
     matrix:
      project: [moneyquiz-webadmin,webadmin,./webadmin/Dockerfile]
      project1: [moneyquiz-webclient,webclient,./webclient/Dockerfile ]
      project2: [moneyquiz-webservice,webservice,./webservice/Dockerfile ]
    permissions:
      contents: read
      packages: write
    secrets:
      GHCR_TOKEN: ${{ secrets.GHCR_TOKEN }}
      REPOSITORY_OWNER: ${{ secrets.REPOSITORY_OWNER }}  
    uses: ./.github/workflows/commonbuild.yml  
    with:
     image: ${{ matrix.project }}, ${{ matrix.project1 }}, ${{ matrix.project2 }}
     context: ${{ matrix.project }}, ${{ matrix.project1 }}, ${{ matrix.project2 }}
     file: ${{ matrix.project }}, ${{ matrix.project1 }}, ${{ matrix.project2 }}
